var VueKuzzle=function(e){"use strict";function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t,n,r,i,o,a){try{var u=e[o](a),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,i)}function w(u){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=u.apply(e,a);function i(e){s(r,t,n,i,o,"next",e)}function o(e){s(r,t,n,i,o,"throw",e)}i(void 0)})}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function v(i){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{},t=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),t.forEach(function(e){var t,n,r;t=i,r=o[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r})}return i}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function n(e,t){return(n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function y(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var g=function(){function i(e,t,n){var r=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];a(this,i),this.type=null,this.vm=e,this.key=t,this.initialOptions=n,this.options=Object.assign({},n),this._skip=!1,this._watchers=[],this._destroyed=!1,this._loading=!1,e.$data.$kuzzleData&&!e.$data.$kuzzleData.queries[t]&&e.$set(e.$data.$kuzzleData.queries,t,{loading:!1}),this._hasDataField=this.vm.$data.hasOwnProperty(t),this._initData(),r&&this.autostart()}var e,t;return u(i,[{key:"autostart",value:function(){"function"==typeof this.options.skip?this._skipWatcher=this.vm.$watch(this.options.skip.bind(this.vm),this.skipChanged.bind(this),{immediate:!0,deep:this.options.deep}):this.options.skip?this._skip=!0:this.start()}},{key:"skipChanged",value:function(e,t){e!==t&&(this.skip=e)}},{key:"fetchMore",value:function(){}},{key:"refresh",value:(t=w(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._skip){e.next=5;break}return e.next=3,this.stop();case 3:return e.next=5,this.start();case 5:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})},{key:"start",value:function(){var t=this;if(this.starting=!0,"function"==typeof this.initialOptions.document){var e=this.initialOptions.document.bind(this.vm);this.options.document=e(),this._watchers.push(this.vm.$watch(e,function(e){t.options.document=e,t.refresh()},{deep:this.options.deep}))}if("function"==typeof this.initialOptions.search){var n=this.initialOptions.search.bind(this.vm);this.options.search=n(),this._watchers.push(this.vm.$watch(n,function(e){t.options.search=e,t.refresh()},{deep:this.options.deep}))}return this.executeKuzzle()}},{key:"stop",value:(e=w(regeneratorRuntime.mark(function e(){var t,n,r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(n=!(t=!0),r=void 0,e.prev=3,i=this._watchers[Symbol.iterator]();!(t=(o=i.next()).done);t=!0)(0,o.value)();e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),n=!0,r=e.t0;case 11:e.prev=11,e.prev=12,t||null==i.return||i.return();case 14:if(e.prev=14,n)throw r;e.next=17;break;case 17:return e.finish(14);case 18:return e.finish(11);case 19:if(this.sub)return e.next=22,this.client.realtime.unsubscribe(this.sub);e.next=23;break;case 22:this.sub=null;case 23:case"end":return e.stop()}},e,this,[[3,7,11,19],[12,,14,18]])})),function(){return e.apply(this,arguments)})},{key:"executeKuzzle",value:function(){this.starting=!1}},{key:"_initData",value:function(){var e=this;this.options.manual||(this._hasDataField?Object.defineProperty(this.vm.$data.$kuzzleData.data,this.key,{get:function(){return e.vm.$data[e.key]},enumerable:!0,configurable:!0}):Object.defineProperty(this.vm.$data,this.key,{get:function(){return e.vm.$data.$kuzzleData.data[e.key]},enumerable:!0,configurable:!0}))}},{key:"setData",value:function(e){"object"===d(e)&&Object.freeze(e),this.vm.$set(this._hasDataField?this.vm.$data:this.vm.$data.$kuzzleData.data,this.key,e)}},{key:"getData",value:function(){return this._hasDataField?this.vm.$data[this.key]:this.vm.$data.$kuzzleData.data[this.key]}},{key:"callHandlers",value:function(e){for(var t=!1,n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=!0,a=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(o=(s=c.next()).done);o=!0){var l=s.value;if(l){t=!0;var f=l.apply(this.vm,r);if(void 0!==f&&!f)break}}}catch(e){a=!0,u=e}finally{try{o||null==c.return||c.return()}finally{if(a)throw u}}return t}},{key:"errorHandler",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.callHandlers.apply(this,[[this.options.error,this.vm.$kuzzle.error,this.vm.$kuzzle.provider.errorHandler]].concat(t))}},{key:"catchError",value:function(e){var t;this.errorHandler(e)||(console.error("[vue-kuzzle] An error has occured for ".concat(this.type," '").concat(this.key,"'")),Array.isArray(e)?(t=console).error.apply(t,y(e)):console.error(e))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.stop(),this._skipWatcher&&this._skipWatcher())}},{key:"skip",get:function(){return this._skip},set:function(e){e?this.stop():this.start(),this._skip=e}},{key:"hasMore",get:function(){return!1}},{key:"client",get:function(){var e=this.options.client||"defaultClient";return this.vm.$kuzzle.provider.clients[e]}},{key:"clientSupportsRealtime",get:function(){return void 0===this.client.protocol.http}},{key:"index",get:function(){var e=this.options.index||this.vm.$kuzzle.index||this.vm.$kuzzle.provider.defaultIndex;if(!e)throw new Error("Index was not specified");return e}},{key:"collection",get:function(){var e=this.options.collection||this.vm.$kuzzle.collection||this.vm.$kuzzle.provider.defaultCollection;if(!e)throw new Error("Collection was not specified");return e}},{key:"loading",get:function(){return this.vm.$data.$kuzzleData&&this.vm.$data.$kuzzleData.queries[this.key]?this.vm.$data.$kuzzleData.queries[this.key].loading:this._loading},set:function(e){this._loading!==e&&(this._loading=e,this.vm.$data.$kuzzleData&&this.vm.$data.$kuzzleData.queries[this.key]&&(this.vm.$data.$kuzzleData.queries[this.key].loading=e,this.vm.$data.$kuzzleData.loading+=e?1:-1))}}]),i}();function x(e,t){var n={};for(var r in t)$(t[r],e[r])||(n[r]=t[r]);return n}var m=Array.isArray,k=Object.keys,z=Object.prototype.hasOwnProperty,b=function(e){for(var t=[],n=k(e),r=0;r<n.length;r++){var i=n[r];void 0!==e[i]&&t.push(i)}return t};function $(e,t,n){if(e===t)return!0;if(e&&t&&"object"==d(e)&&"object"==d(t)){var r,i,o,a=m(e),u=m(t);if(a&&u){if((i=e.length)!=t.length)return!1;for(r=i;0!=r--;)if(!$(e[r],t[r],n))return!1;return!0}if(a!=u)return!1;var s=e instanceof Date,c=t instanceof Date;if(s!=c)return!1;if(s&&c)return e.getTime()==t.getTime();var l=e instanceof RegExp,f=t instanceof RegExp;if(l!=f)return!1;if(l&&f)return e.toString()==t.toString();var h=n?b(e):k(e),p=k(t);if((i=h.length)!==p.length)return!1;for(r=i;0!=r--;)if(!z.call(t,h[r]))return!1;for(r=i;0!=r--;)if(!$(e[o=h[r]],t[o],n))return!1;return!0}return e!=e&&t!=t}var _=function(e){function o(e,t,n){var r;(a(this,o),"object"!==d(n))&&(n={document:n});return(r=h(this,l(o).call(this,e,t,n,!1))).type="document",e.$data.$kuzzleData&&!e.$data.$kuzzleData.documents[t]&&e.$set(e.$data.$kuzzleData.documents,t,e.$data.$kuzzleData.queries[t]),r.firstRun=new Promise(function(e,t){r._firstRunResolve=e,r._firstRunReject=t}),r}var t,r,n,i;return c(o,g),u(o,[{key:"executeKuzzle",value:(i=w(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.starting=!0,t=this.options,n=t.document,r=t.subscribe,this.setLoading(),e.prev=3,e.next=6,this.client.document.get(this.index,this.collection,n);case 6:if(i=e.sent)return e.next=10,this.nextResult(i._source,i,"get");e.next=10;break;case 10:this.loadingDone(null,i._source),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),this.catchError(e.t0);case 16:if(r)return e.next=19,this.startDocumentSubscription(n);e.next=19;break;case 19:p(l(o.prototype),"executeKuzzle",this).call(this);case 20:case"end":return e.stop()}},e,this,[[3,13]])})),function(){return i.apply(this,arguments)})},{key:"startDocumentSubscription",value:(n=w(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.clientSupportsRealtime||this.sub)return e.abrupt("return");e.next=2;break;case 2:return e.prev=2,e.next=5,this.client.realtime.subscribe(this.index,this.collection,{ids:{values:[t]}},function(e){return n.nextResult(e.result._source,e.result,"subscription")},{subscribeToSelf:!1});case 5:this.sub=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),this.catchError(e.t0);case 11:case"end":return e.stop()}},e,this,[[2,8]])})),function(e){return n.apply(this,arguments)})},{key:"nextResult",value:(r=w(regeneratorRuntime.mark(function e(t,n,r){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if("function"==typeof this.options.update)return e.next=5,Promise.resolve(this.options.update.call(this.vm,t,n,r));e.next=9;break;case 5:i=e.sent,this.setData(i),e.next=10;break;case 9:this.setData(t);case 10:case"end":return e.stop()}},e,this)})),function(e,t,n){return r.apply(this,arguments)})},{key:"setLoading",value:function(){this.loading||this.applyLoadingModifier(1),this.loading=!0}},{key:"catchError",value:function(e){p(l(o.prototype),"catchError",this).call(this,e),this.loadingDone(e)}},{key:"watchLoading",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.callHandlers.apply(this,[[this.options.watchLoading,this.vm.$kuzzle.watchLoading,this.vm.$kuzzle.provider.watchLoading]].concat(t,[this]))}},{key:"applyLoadingModifier",value:function(e){var t=this.loadingKey;t&&"number"==typeof this.vm[t]&&(this.vm[t]+=e),this.watchLoading(1===e,e)}},{key:"loadingDone",value:function(e,t){this.loading&&this.applyLoadingModifier(-1),this.loading=!1,e?this.firstRunReject(e):(this.changeRun||(this.changeRun=this.firstRun),this.firstRunResolve(t))}},{key:"refetch",value:(t=w(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(),e.prev=1,e.next=4,this.client.document.get(this.index,this.collection,this.options.document);case 4:t=e.sent,this.loadingDone(),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.catchError(e.t0);case 11:if(t)return e.next=14,this.nextResult(t._source,t,"get");e.next=14;break;case 14:case"end":return e.stop()}},e,this,[[1,8]])})),function(){return t.apply(this,arguments)})},{key:"change",value:function(c){var l=this;if(this.setLoading(),this.changeRun||(this.changeRun=Promise.resolve(null)),"function"==typeof this.options.document){var e=this.options.document.bind(this.vm);this.options.document=e()}var f=this.changeRun=this.changeRun.then(function(){var t=w(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,u,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t&&Object.keys(t).every(function(e){return"_kuzzle_info"===e||c.hasOwnProperty(e)}),r=n?x(t,c):c,i={index:l.index,collection:l.collection,id:l.options.document,documentKey:l.key,savedDocument:t,changedDocument:c},"function"==typeof(o=l.options.changeFilter||l.vm.$kuzzle.changeFilter||l.vm.$kuzzle.provider.changeFilter))return e.prev=5,e.next=8,Promise.resolve(o.call(l.vm,r,i));e.next=15;break;case 8:r=e.sent,e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(5),l.catchError(e.t0),e.abrupt("return",t);case 15:if(r&&0!==Object.keys(r).length){e.next=18;break}return l.loadingDone(),e.abrupt("return",t);case 18:if(e.prev=18,l.options.document){e.next=25;break}return e.next=22,l.client.document.create(l.index,l.collection,r,null,{refresh:"wait_for"});case 22:a=e.sent,e.next=34;break;case 25:if(n){e.next=31;break}return e.next=28,l.client.document.createOrReplace(l.index,l.collection,l.options.document,r,{refresh:"wait_for"});case 28:a=e.sent,e.next=34;break;case 31:return e.next=33,l.client.document.update(l.index,l.collection,l.options.document,r,{refresh:"wait_for"});case 33:a=e.sent;case 34:return e.next=36,l.client.document.get(l.index,l.collection,a._id);case 36:if(u=e.sent._source,s=u,"function"==typeof l.options.update)return e.next=41,Promise.resolve(l.options.update.call(l.vm,u,a,a.created?"created":a.result));e.next=42;break;case 41:s=e.sent;case 42:return l.changeRun===f&&l.setData(s),l.loadingDone(),e.abrupt("return",u);case 47:return e.prev=47,e.t1=e.catch(18),l.catchError(e.t1),e.abrupt("return",t);case 51:case"end":return e.stop()}},e,null,[[5,11],[18,47]])}));return function(e){return t.apply(this,arguments)}}());return f.then(function(){return l.getData()})}},{key:"_initData",value:function(){var t=this;this.options.manual||(this._hasDataField?Object.defineProperty(this.vm.$data.$kuzzleData.data,this.key,{get:function(){return t.vm.$data[t.key]},set:function(e){return t.change(e)},enumerable:!0,configurable:!0}):Object.defineProperty(this.vm.$data,this.key,{get:function(){return t.vm.$data.$kuzzleData.data[t.key]},set:function(e){return t.change(e)},enumerable:!0,configurable:!0}))}},{key:"firstRunResolve",value:function(e){this._firstRunResolve&&(this._firstRunResolve(e),this._firstRunResolve=null)}},{key:"firstRunReject",value:function(e){this._firstRunReject&&(this._firstRunReject(e),this._firstRunReject=null)}},{key:"destroy",value:function(){p(l(o.prototype),"destroy",this).call(this),this.loading&&this.watchLoading(!1,-1),this.loading=!1}},{key:"loadingKey",get:function(){return this.options.loadingKey||this.vm.$kuzzle.loadingKey}}]),o}(),R=function(e){function i(e,t,n){var r;return a(this,i),(r=h(this,l(i).call(this,e,t,n,!1))).type="search",r}var t,n;return c(i,g),u(i,[{key:"executeKuzzle",value:(n=w(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.options.search,e.prev=1,e.next=4,this.client.document.search(this.index,this.collection,{query:t.query,aggregations:t.aggregations,sort:t.sort},{from:t.from||0,size:t.size||10});case 4:this.response=e.sent,n=this.response.hits.map(function(e){return e._source}),this.nextResult(n,this.response),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),this.catchError(e.t0);case 12:p(l(i.prototype),"executeKuzzle",this).call(this);case 13:case"end":return e.stop()}},e,this,[[1,9]])})),function(){return n.apply(this,arguments)})},{key:"fetchMore",value:(t=w(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.response){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.response.next();case 5:t=e.sent,(n=t.hits.map(function(e){return e._source}))&&(r=[].concat(y(this.getData()),y(n)),this.nextResult(r,t)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),this.catchError(e.t0);case 13:case"end":return e.stop()}},e,this,[[2,10]])})),function(){return t.apply(this,arguments)})},{key:"nextResult",value:function(e,t){"function"==typeof this.options.update?this.setData(this.options.update.call(this.vm,e,t)):this.setData(e)}},{key:"hasMore",get:function(){return!!this.response&&this.response.fetched<this.response.total}}]),i}(),i=function(){function t(e){a(this,t),this._kuzzleSubscriptions=[],this._watchers=[],this.vm=e,this.queries={},this.documents={},this.searches={},this.client=void 0,this.loadingKey=void 0,this.error=void 0}var r,n,i,o;return u(t,[{key:"getClient",value:function(e){if(!e||!e.client){if("object"===d(this.client))return this.client;if(this.client){if(this.provider.clients){var t=this.provider.clients[this.client];if(!t)throw new Error("[vue-kuzzle] Missing client '".concat(this.client,"' in 'kuzzleProvider'"));return t}throw new Error("[vue-kuzzle] Missing 'clients' options in 'kuzzleProvider'")}return this.provider.defaultClient}var n=this.provider.clients[e.client];if(!n)throw new Error("[vue-kuzzle] Missing client '".concat(e.client,"' in 'kuzzleProvider'"));return n}},{key:"query",value:function(e,t){var n=this.getIndexAndCollection(t),r=n.index,i=n.collection;try{return this.getClient(t).query({index:r,collection:i,controller:t.controller,action:t.action,_id:t.id,body:e,refresh:"wait_for"})}catch(e){throw new Error("[vue-kuzzle] ".concat(e))}}},{key:"get",value:(o=w(regeneratorRuntime.mark(function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getIndexAndCollection(n,"getDocument"),i=r.index,o=r.collection,e.next=3,this.getClient(n).document.get(i,o,t);case 3:return a=e.sent,e.abrupt("return",v({},a._source,{_kuzzle_response:a}));case 5:case"end":return e.stop()}},e,this)})),function(e,t){return o.apply(this,arguments)})},{key:"search",value:(i=w(regeneratorRuntime.mark(function e(t,n){var r,i,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getIndexAndCollection(n,"searchDocuments"),i=r.index,o=r.collection,e.next=3,this.getClient(n).document.search(i,o,{query:t,aggregations:n&&n.aggregations,sort:n&&n.sort},{from:n&&n.from||0,size:n&&n.size||10});case 3:return a=e.sent,(u=(a.hits||[]).slice())._kuzzle_response=a,e.abrupt("return",u);case 7:case"end":return e.stop()}},e,this)})),function(e,t){return i.apply(this,arguments)})},{key:"create",value:(n=w(regeneratorRuntime.mark(function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getIndexAndCollection(n,"createDocument"),i=r.index,o=r.collection,!n||!0!==n.replace){e.next=7;break}if(n.id){e.next=4;break}throw new Error("[vue-kuzzle] Missing 'id' in 'createDocument' called with 'replace: true'");case 4:return e.next=6,this.getClient(n).document.createOrReplace(i,o,n&&n.id,t,{refresh:"wait_for"});case 6:a=e.sent;case 7:return e.next=9,this.getClient(n).document.create(i,o,t,n&&n.id,{refresh:"wait_for"});case 9:return a=e.sent,e.abrupt("return",v({},a._source,{_kuzzle_response:a}));case 11:case"end":return e.stop()}},e,this)})),function(e,t){return n.apply(this,arguments)})},{key:"change",value:(r=w(regeneratorRuntime.mark(function e(t,n,r){var i,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getIndexAndCollection(r,"changeDocument"),o=i.index,a=i.collection,r&&!0===r.replace)return e.next=4,this.getClient(r).document.replace(o,a,t,n,{refresh:"wait_for"});e.next=5;break;case 4:u=e.sent;case 5:return e.next=7,this.getClient(r).document.update(o,a,t,n,{refresh:"wait_for"});case 7:return u=e.sent,e.abrupt("return",v({},u._source,{_kuzzle_response:u}));case 9:case"end":return e.stop()}},e,this)})),function(e,t,n){return r.apply(this,arguments)})},{key:"delete",value:function(e,t){var n=this.getIndexAndCollection(t,"deleteDocument"),r=n.index,i=n.collection;return this.getClient(t).document.delete(r,i,e,{refresh:"wait_for"})}},{key:"addSmartDocumentOrSearch",value:function(e,t){var n,r=function(e,t){for(;"function"==typeof e;)e=e.call(t);return e}(t,this.vm);if(void 0!==r.document)n=this.queries[e]=this.documents[e]=new _(this.vm,e,r,!1);else{if("undefined"===r.search)throw new Error("[vue-kuzzle] Missing either 'document' or 'search' in 'kuzzle.".concat(e,"' options"));n=this.queries[e]=this.searches[e]=new R(this.vm,e,r,!1)}return this.vm.$isServer||n.autostart(),n}},{key:"defineReactiveSetter",value:function(t,e,n){var r=this;this._watchers.push(this.vm.$watch(e,function(e){r[t]=e},{immediate:!0,deep:n}))}},{key:"getIndexAndCollection",value:function(e,t){var n=e&&e.index||this.index||this.provider.defaultIndex,r=e&&e.collection||this.collection||this.provider.defaultCollection;if(t){if(!n)throw new Error("[vue-kuzzle] Missing index in '".concat(t,"'"));if(!r)throw new Error("[vue-kuzzle] Missing collection in '".concat(t,"'"))}return{index:n,collection:r}}},{key:"destroy",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,i=this._watchers[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)()}}catch(e){t=!0,n=e}finally{try{e||null==i.return||i.return()}finally{if(t)throw n}}for(var o in this.queries)this.queries[o].destroy();this.vm=null}},{key:"provider",get:function(){return this.vm.$kuzzleProvider}},{key:"loading",get:function(){return 0!==this.vm.$data.$kuzzleData.loading}},{key:"data",get:function(){return this.vm.$data.$kuzzleData.data}}]),t}(),t=function(){function t(e){if(a(this,t),!e)throw new Error("Options argument required");this.clients=e.clients||{},this.clients.defaultClient=this.defaultClient=e.defaultClient,this.defaultOptions=e.defaultOptions||{},this.defaultIndex=e.defaultIndex,this.defaultCollection=e.defaultCollection,this.watchLoading=e.watchLoading,this.errorHandler=e.errorHandler,this.changeFilter=e.changeFilter,this.connectAll()}return u(t,[{key:"connectAll",value:function(){return this._connectAllPromise||(this._connectAllPromise=Promise.all(Object.values(this.clients).map(function(e){return e.connect()}))),this._connectAllPromise}}]),t}();function o(e,t){return void 0!==e&&Object.prototype.hasOwnProperty.call(e,t)}function O(){var e=this.$options,t=e.kuzzleProvider;t?this.$kuzzleProvider="function"==typeof t?t():t:e.parent&&e.parent.$kuzzleProvider&&(this.$kuzzleProvider=e.parent.$kuzzleProvider)}function D(){var e=this,t=this.$kuzzleProvider;if(!this._kuzzleLaunched&&t){this._kuzzleLaunched=!0;var n=this.$options.kuzzle;if(n)for(var r in this.$_kuzzlePromises=[],n.$init||(n.$init=!0,t.defaultOptions&&(n=this.$options.kuzzle=Object.assign({},t.defaultOptions,n))),j(this.$kuzzle,"client",n.$client,n.$deep),j(self.$kuzzle,"index",n.$index,n.$deep),j(self.$kuzzle,"collection",n.$collection,n.$deep),j(this.$kuzzle,"loadingKey",n.$loadingKey,n.$deep),j(this.$kuzzle,"error",n.$error,n.$deep),j(this.$kuzzle,"watchLoading",n.$watchLoading,n.$deep),Object.defineProperty(this,"$kuzzleData",{get:function(){return e.$data.$kuzzleData},enumerable:!0,configurable:!0}),n)if("$"!==r.charAt(0)){var i=n[r],o=this.$kuzzle.addSmartDocumentOrSearch(r,i);!1!==i.prefetch&&!1!==n.$prefetch&&this.$_kuzzlePromises.push(o.firstRun)}}}function j(e,t,n,r){void 0!==n&&("function"==typeof n?e.defineReactiveSetter(t,n,r):e[t]=n)}function P(){this.$_kuzzle&&(this.$_kuzzle.destroy(),this.$_kuzzle=null)}function E(e,t){e.mixin(v({},"1"===t?{init:O}:{},"2"===t?{data:function(){return{$kuzzleData:{queries:{},documents:{},searches:{},loading:0,data:this.$_kuzzleInitData}}},beforeCreate:function(){O.call(this),function(){var n=this;this.$_kuzzleInitData={};var e=this.$options.kuzzle;if(e){var t=function(t){"$"!==t.charAt(0)&&(e[t].manual||o(n.$options.props,t)||o(n.$options.computed,t)||o(n.$options.methods,t)||Object.defineProperty(n,t,{get:function(){return n.$data.$kuzzleData.data[t]},set:function(e){return n.$_kuzzleInitData[t]=e},enumerable:!0,configurable:!0}))};for(var r in e)t(r)}}.call(this)},serverPrefetch:function(){if(this.$_kuzzlePromises)return Promise.all(this.$_kuzzlePromises)}}:{},{created:D,destroyed:P}))}var C=function(e){return Object.prototype.toString.call(e)},S="function"==typeof Symbol&&Symbol.for,A=function(e){return e},K={enumerable:!0,configurable:!0,get:A,set:A};function M(e,t,n,r){K.get=n,K.set=r||A,Object.defineProperty(e,t,K)}var q=Object.prototype.hasOwnProperty;function I(e,t){return q.call(e,t)}function L(e,t){if(!e)throw new Error("[vue-function-api] "+t)}function T(e){return"[object Array]"===C(e)}function F(e){return"[object Object]"===C(e)}var V=null,H=null;function N(){return L(V,"must call Vue.use(plugin) before using any function."),V}function W(){return H}function Q(e){H=e}var U=function(){function e(){}return e.prototype.setVmProperty=function(e,t){var n=this;this._vm=e,this._propName=t;var r=e.$options.props,i=e.$options.methods,o=e.$options.computed,a=N().util.warn;t in e?I(e.$data,t)?a('The setup binding property "'+t+'" is already declared as a data.',e):r&&I(r,t)?a('The setup binding property "'+t+'" is already declared as a prop.',e):i&&I(i,t)?a('The setup binding property "'+t+'" is already declared as a method.',e):a(o&&t in o?'The setup binding property "'+t+'" is already declared as a computed.':'The setup binding property "'+t+'" is already declared.',e):(M(e,t,function(){return n.value},function(e){n.value=e}),this.exposeToDevtool())},e}(),B=function(e,t){return(B=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function G(e,t){function n(){this.constructor=e}B(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var J=function(){return(J=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},X=function(n){function e(e){var t=n.call(this)||this;return t._internal=e,t}return G(e,n),Object.defineProperty(e.prototype,"value",{get:function(){return this._internal.$$state},set:function(e){this._internal.$$state=e},enumerable:!0,configurable:!0}),e.prototype.exposeToDevtool=function(){var t=this,e=this._vm,n=this._propName;M(e._data,n,function(){return t.value},function(e){t.value=e})},e}(U),Y=function(n){function e(e){var t=n.call(this)||this;return t._internal=e,t}return G(e,n),Object.defineProperty(e.prototype,"value",{get:function(){return this._internal.read()},set:function(e){this._internal.write?this._internal.write(e):N().util.warn("Computed property"+(this._propName?' "'+this._propName+'"':"")+" was assigned to but it has no setter.",this._vm)},enumerable:!0,configurable:!0}),e.prototype.exposeToDevtool=function(){var t=this,e=this._vm,n=this._propName;e.$options.computed||(e.$options.computed={}),M(e.$options.computed,n,function(){return{get:function(){return t.value},set:function(e){t.value=e}}})},e}(U);function Z(e){return e instanceof U}function ee(e){var t=W();return L(t,'"'+e+'" get called outside of "setup()"'),t}function te(e,t){V&&V===e?L(!1,"already installed. Vue.use(plugin) should be called only once"):(e.config.optionMergeStrategies.setup=function(n,r){return function(e,t){return function e(t,n){if(!n)return t;for(var r,i,o,a=S?Reflect.ownKeys(n):Object.keys(n),u=0;u<a.length;u++)"__ob__"!==(r=a[u])&&(i=t[r],o=n[r],I(t,r)?i!==o&&F(i)&&!Z(i)&&F(o)&&!Z(i)&&e(i,o):t[r]=o);return t}("function"==typeof r&&r(e,t)||{},"function"==typeof n&&n(e,t)||{})}},V=e,t(e))}function ne(a){a.mixin({created:function(){var n,r=this,e=r.$options.setup;if(!e)return;if("function"!=typeof e)return void a.util.warn('The "setup" option should be a function that returns a object in component definitions.',r);Q(r);var t=(i=r,o={},["parent","root","refs","slots","attrs"].forEach(function(e){M(o,e,function(){return i["$"+e]},function(){a.util.warn("Cannot assign to '"+e+"' because it is a read-only property",i)})}),["emit"].forEach(function(e){return M(o,e,function(){var n="$"+e;return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i[n].apply(i,e)}})}),o);var i,o;try{n=e(r.$props||{},t)}catch(e){a.util.warn('there is an error occuring in "setup"',r),console.log(e)}finally{Q(null)}if(!n)return;if(!F(n))return void L(!1,'"setup" must return a "Object", get "'+Object.prototype.toString.call(n).slice(8,-1)+'"');Object.keys(n).forEach(function(e){var t=n[e];Z(t)?t.setVmProperty(r,e):r[e]=t})}})}function re(e){return new X(function(e){var t=N();if(t.observable)return t.observable(e);var n=t.config.silent;t.config.silent=!0;var r=new t({data:{$$state:e}});return t.config.silent=n,r._data.$$state}({$$state:T(e)||F(e)?function e(t){if(!t)return t;for(var n=Object.keys(t),r=0;r<n.length;r++){var i=n[r],o=t[i];Z(o)?t[i]=o.value:(F(o)||T(o))&&(t[i]=e(o))}return t}(e):e}))}var ie,oe,ae;ie=["destroyed","deactivated"],oe="on"+((ae="unmounted")[0].toUpperCase()+ae.slice(1));function ue(e){return S?Symbol.for(e):e}var se,ce=ue("vfa.key.preFlushQueue"),le=ue("vfa.key.postFlushQueue"),fe={};function he(e){return function(){pe(this,e)}}function pe(e,t){for(var n=e[t],r=0;r<n.length;r++)n[r]();n.length=0}function de(e,t,n){function r(){e.$nextTick(function(){e[ce].length&&pe(e,ce),e[le].length&&pe(e,le)})}switch(n){case"pre":r(),e[ce].push(t);break;case"post":r(),e[le].push(t);break;case"sync":t();break;default:L(!1,'flush must be one of ["post", "pre", "sync"], but got '+n)}}function ve(e,t,n){void 0===n&&(n={});var r,i=J({lazy:!1,deep:!1,flush:"post"},n),o=W();if(!o){if(!se){var a=N(),u=a.config.silent;a.config.silent=!0,se=new a,a.config.silent=u}o=se,i.flush="sync"}return void 0===o[ce]&&((r=o)[ce]=[],r[le]=[],r.$on("hook:beforeUpdate",he(ce)),r.$on("hook:updated",he(le))),T(e)?function(r,e,t,i){var n=!i.lazy&&e.length,o=!1,a=[];function u(){t.apply(r,a.reduce(function(e,t){return e[0].push(t.value===fe?t.getter():t.value),e[1].push(t.oldValue===fe?void 0:t.oldValue),e},[[],[]]))}var s=function(){!1!==n?0==--n&&(n=!1,s=c,u()):(s=c)()},c=function(){o||(o=!0,r.$nextTick(function(){de(r,function(){o=!1,u()},i.flush)}))};return e.forEach(function(e){var t,n={getter:t=Z(e)?function(){return e.value}:e,value:fe,oldValue:fe};a.push(n),n.watcherStopHandle=r.$watch(t,function(e,t){n.value=e,n.oldValue=t,s()},{immediate:!i.lazy,deep:i.deep,sync:!0})}),function(){a.forEach(function(e){return e.watcherStopHandle()})}}(o,e,t,i):function(n,e,r,i){var t;t=Z(e)?function(){return e.value}:e;var o=function(e,t){o=a,i.lazy?a(e,t):r(e,t)},a=function(e,t){de(n,function(){r(e,t)},i.flush)};return n.$watch(t,function(e,t){o(e,t)},{immediate:!i.lazy,deep:i.deep,sync:"sync"===i.flush})}(o,e,t,i)}function ye(e,t){var n=function(e){var t=N(),n=t.config.silent;t.config.silent=!0;var r=new t({computed:e});return t.config.silent=n,r}({$$state:{get:e,set:t}});return new Y(J({read:function(){return n.$$state}},t&&{write:function(e){n.$$state=e}}))}function ge(e){if(e)return function(e,t){for(var n=t;n;){if(n._provided&&I(n._provided,e))return n._provided[e];n=n.$parent}N().util.warn('Injection "'+String(e)+'" not found',t)}(e,ee("inject"))}function me(r){var e=r&&r.provider,t=we(e,r);if(t)return t;var i=e||ge("kuzzleProvider");if(!i)throw new Error("[useKuzzle] Missing 'kuzzleProvider' to be provided via 'provide'");if(e){var n=we(i,r);if(n)return xe(null,r,n),n}var o=i.defaultIndex,a=i.defaultCollection,s=function(e){if(e&&e.client){if("object"===d(e.client))return e.client;if(i.clients){var t=i.clients[e.client];if(!t)throw new Error("[useKuzzle] Missing client '".concat(e.client,"' in 'kuzzleProvider'"));return t}throw new Error("[useKuzzle] Missing 'clients' options in 'kuzzleProvider'")}if(!r||!r.client)return i.defaultClient;var n=i.clients[r.client];if(!n)throw new Error("[useKuzzle] Missing client '".concat(r.client,"' in 'kuzzleProvider'"));return n},c=function(e,t){var n=e&&e.index||o,r=e&&e.collection||a;if(t){if(!n)throw new Error("[useKuzzle] Missing index in '".concat(t,"'"));if(!r)throw new Error("[useKuzzle] Missing collection in '".concat(t,"'"))}return{index:n,collection:r}},u=function(){var n=w(regeneratorRuntime.mark(function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c(n,"getDocument"),i=r.index,o=r.collection,e.next=3,s(n).document.get(i,o,t);case 3:return a=e.sent,e.abrupt("return",v({},a._source,{_kuzzle_response:a}));case 5:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),l=function(){var n=w(regeneratorRuntime.mark(function e(t,n){var r,i,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=c(n,"searchDocuments"),i=r.index,o=r.collection,e.next=3,s(n).document.search(i,o,{query:t,aggregations:n&&n.aggregations,sort:n&&n.sort},{from:n&&n.from||0,size:n&&n.size||10});case 3:return a=e.sent,(u=(a.hits||[]).slice())._kuzzle_response=a,e.abrupt("return",u);case 7:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),f=function(){var n=w(regeneratorRuntime.mark(function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c(n,"createDocument"),i=r.index,o=r.collection,!n||!0!==n.replace){e.next=7;break}if(n.id){e.next=4;break}throw new Error("[vue-kuzzle] Missing 'id' in 'createDocument' called with 'replace: true'");case 4:return e.next=6,s(n).document.createOrReplace(i,o,n&&n.id,t,{refresh:"wait_for"});case 6:a=e.sent;case 7:return e.next=9,s(n).document.create(i,o,t,n&&n.id,{refresh:"wait_for"});case 9:return a=e.sent,e.abrupt("return",v({},a._source,{_kuzzle_response:a}));case 11:case"end":return e.stop()}},e)}));return function(e,t){return n.apply(this,arguments)}}(),h=function(){var r=w(regeneratorRuntime.mark(function e(t,n,r){var i,o,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=c(r,"changeDocument"),o=i.index,a=i.collection,r&&!0===r.replace)return e.next=4,s(r).document.replace(o,a,t,n,{refresh:"wait_for"});e.next=5;break;case 4:u=e.sent;case 5:return e.next=7,s(r).document.update(o,a,t,n,{refresh:"wait_for"});case 7:return u=e.sent,e.abrupt("return",v({},u._source,{_kuzzle_response:u}));case 9:case"end":return e.stop()}},e)}));return function(e,t,n){return r.apply(this,arguments)}}(),p={provider:i,getClient:s,query:function(e,t){var n=c(t),r=n.index,i=n.collection;try{return s(t).query({index:r,collection:i,controller:t.controller,action:t.action,_id:t.id,body:e,refresh:"wait_for"})}catch(e){throw new Error("[useKuzzle] ".concat(e))}},get:u,search:l,create:f,change:h,delete:function(e,t){var n=c(t,"deleteDocument"),r=n.index,i=n.collection;return s(t).document.delete(r,i,e,{refresh:"wait_for"})},getIndexAndCollection:c};return xe(e,r,p),p}V&&"undefined"!=typeof window&&window.Vue&&te(window.Vue,ne);var ke=new Map,ze=function(e){return e||"default"},be=function(e){var t=null;return e&&(t=e.client||"default"),t||"default"};function we(e,t){var n=ze(e),r=ke.get(n);return r?r[be(t)]:null}function xe(e,t,n){var r=ze(e),i=ke.get(r);i||(i={}),i[be(t)]=n,ke.set(r,i)}function $e(e,t){if(!$e.installed){$e.installed=!0;var n=e.version.substr(0,e.version.indexOf("."));Object.defineProperty(e.prototype,"$kuzzle",{get:function(){return this.$_kuzzle||(this.$_kuzzle=new i(this)),this.$_kuzzle}}),E(e,n)}}t.install=$e;var _e=t,Re=null;return"undefined"!=typeof window?Re=window.Vue:"undefined"!=typeof global&&(Re=global.Vue),Re&&Re.use(t),e.install=$e,e.KuzzleProvider=_e,e.default=t,e.useKuzzle=me,e.fetchKuzzle=function(v){if(!v||!v.document)throw new Error("[fetchKuzzle] Missing `document` in options");var y,g=me(v),o=re(!1),m=re(!1),k=re(null),t=re(null),z="function"==typeof v.document?ye(v.document):re(v.document),e="function"==typeof v.skip?ye(v.skip):re(v.skip),b=function(e){t.value=e,o.value=!1,m.value=!1,"function"==typeof v.error?v.error(e):console.error(e)};ve(function(){return e.value?null:z.value},(n=w(regeneratorRuntime.mark(function e(t){var n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return o.value=!0,e.next=5,g.provider.connectAll();case 5:return e.prev=5,e.next=8,g.get(t,v);case 8:n=e.sent,r=n._kuzzle_response,i=f(n,["_kuzzle_response"]),o.value=!1,v.update?k.value=v.update(i,r):k.value=i,y||(y=Promise.resolve(k.value)),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),b(e.t0);case 19:case"end":return e.stop()}},e,null,[[5,16]])})),function(e){return n.apply(this,arguments)}),{lazy:!1});var n;var r=(u=w(regeneratorRuntime.mark(function e(p){var d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.value=!0,y||(y=Promise.resolve(null)),d=y=y.then(function(){var t=w(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,u,s,c,l,f,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t&&Object.keys(t).every(function(e){return"_kuzzle_info"===e||p.hasOwnProperty(e)}),r=n?x(t,p):p,i=g.getIndexAndCollection(v,"change"),o=i.index,a=i.collection,u={kuzzle:g,index:o,collection:a,id:z.value,savedDocument:t,changedDocument:p},"function"==typeof(s=v.changeFilter||g.provider.changeFilter))return e.prev=6,e.next=9,Promise.resolve(s(r,u));e.next=16;break;case 9:r=e.sent,e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(6),b(e.t0),e.abrupt("return",t);case 16:if(r&&0!==Object.keys(r).length){e.next=19;break}return m.value=!1,e.abrupt("return",t);case 19:if(c=g.getClient(v),e.prev=20,z.value){e.next=27;break}return e.next=24,c.document.create(o,a,r,null,{refresh:"wait_for"});case 24:l=e.sent,e.next=36;break;case 27:if(n){e.next=33;break}return e.next=30,c.document.createOrReplace(o,a,z.value,r,{refresh:"wait_for"});case 30:l=e.sent,e.next=36;break;case 33:return e.next=35,c.document.update(o,a,z.value,r,{refresh:"wait_for"});case 35:l=e.sent;case 36:return e.next=38,c.document.get(o,a,l._id);case 38:if(f=e.sent._source,h=f,"function"==typeof v.update)return e.next=43,Promise.resolve(v.update(f,l,l.created?"created":l.result));e.next=44;break;case 43:h=e.sent;case 44:return y===d&&(k.value=h),m.value=!1,e.abrupt("return",h);case 49:return e.prev=49,e.t1=e.catch(20),b(e.t1),e.abrupt("return",t);case 53:case"end":return e.stop()}},e,null,[[6,12],[20,49]])}));return function(e){return t.apply(this,arguments)}}()),e.abrupt("return",d.then(function(){return k.value}));case 4:case"end":return e.stop()}},e)})),function(e){return u.apply(this,arguments)}),i=ye(function(){return o.value||m.value}),a=ye(function(){return k.value},r);var u;return{kuzzle:g,isReading:o,isWriting:m,isLoading:i,data:a,error:t,change:r}},e.searchKuzzle=function(r){if(!r||!r.search)throw new Error("[searchKuzzle] Missing `search` in options");var i=me(r),o=re(!1),a=re(null),t=re(null),u=re(null),e="function"==typeof r.search?ye(r.search):re(r.search),n="function"==typeof r.skip?ye(r.skip):re(r.skip),s=function(e,t){u.value=t,r.update?a.value=r.update(e,t):a.value=e},c=function(e){t.value=e,o.value=!1,"function"==typeof r.error?r.error(e):console.error(e)};ve(function(){return n.value?null:e.value},(l=w(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return o.value=!0,e.next=5,i.provider.connectAll();case 5:return e.prev=5,e.next=8,i.search(t.query||t,t.query?v({},r,{aggregations:t.aggregations,sort:t.sort,from:t.from,size:t.size}):r);case 8:n=e.sent,o.value=!1,s(n,n._kuzzle_response),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),c(e.t0);case 16:case"end":return e.stop()}},e,null,[[5,13]])})),function(e){return l.apply(this,arguments)}),{lazy:!1});var l;var f=ye(function(){return!!u.value&&u.value.fetched<u.value.total}),h=(p=w(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(u.value){e.next=2;break}return e.abrupt("return");case 2:return o.value=!0,e.prev=3,e.next=6,u.value.next();case 6:t=e.sent,0<(n=t.hits.map(function(e){return e._source})).length&&s([].concat(y(a.value),y(n)),u.value),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),c(e.t0);case 14:case"end":return e.stop()}},e,null,[[3,11]])})),function(){return p.apply(this,arguments)});var p;return{kuzzle:i,isLoading:o,data:a,error:t,hasMore:f,fetchMore:h}},e}({});
